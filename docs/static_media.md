# Работа с медиа и статикой

## Общие сведения

В проекте KURS Service используются две отдельные системы хранения файлов:

- **Статические файлы (static)** — CSS, JS, изображения интерфейса, сторонние библиотеки.
- **Медиафайлы (media)** — пользовательские изображения, документы, загружаемые через сайт или админку.

---

## Статические файлы

- Все статические файлы хранятся в папке `kurs_service/static/` и подпапках.
- Для подключения статики в шаблонах используйте тег:

  ```django
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  <img src="{% static 'img/logo.png' %}" alt="Логотип">
  ```

- В проект уже включены Bootstrap, jQuery, FontAwesome и другие необходимые библиотеки.
- При разработке файлы можно размещать в подпапках static соответствующих приложений.
- Для продакшн-сервера используйте команду:

  ```shell
  python manage.py collectstatic
  ```

  Все файлы будут собраны в папку, указанную в `STATIC_ROOT`.

- Пути и настройки:
  - `STATIC_URL` — базовый URL для доступа к статике (например, `/static/`)
  - `STATICFILES_DIRS` — дополнительные директории для поиска статики
  - `STATIC_ROOT` — папка для сбора статики при деплое

---

## Медиафайлы

- Все пользовательские изображения и файлы загружаются в папку `kurs_service/media/`.
- Для загрузки файлов в моделях используйте поля:

  ```python
  from django.db import models

  class Photo(models.Model):
      image = models.ImageField(upload_to='img/photo-gallery/')
      description = models.TextField()
  ```

- Пути к медиа-файлам доступны через `MEDIA_URL` (например, `/media/`).
- Для вывода медиа в шаблонах:

  ```django
  <img src="{{ object.image.url }}" alt="Фото">
  ```

- В Django-админке загрузка файлов происходит автоматически через поля ImageField/FileField.
- Для загрузки файлов через пользовательские формы используйте:

  ```python
  class UploadForm(forms.ModelForm):
      class Meta:
          model = Photo
          fields = ['image']
  ```

  и не забудьте добавить `enctype="multipart/form-data"` в тег `<form>`.

- Пути и настройки:
  - `MEDIA_URL` — базовый URL для доступа к медиа (например, `/media/`)
  - `MEDIA_ROOT` — путь к папке хранения медиа на сервере

---

## Особенности для продакшн-сервера

- В режиме разработки Django сам обслуживает статику и медиа.
- В продакшн-режиме настройте веб-сервер (nginx, Apache) для раздачи `/static/` и `/media/`.
- Не размещайте чувствительные файлы в папке media — доступ к ним не ограничен.
- Регулярно делайте резервные копии папки media.
- Проверьте права доступа: сервер должен иметь права на запись в папку media.

---

## Советы и рекомендации

- Используйте уникальные имена файлов или подпапки для избежания конфликтов.
- Для очистки неиспользуемых файлов используйте сторонние пакеты (например, django-cleanup).
- Не храните большие файлы (видео, архивы) без необходимости — это увеличивает нагрузку на сервер и бэкапы.
- Для оптимизации изображений используйте предварительную обработку (например, Pillow).

---

## Полезные ссылки

- [Документация Django: Работа со статикой](https://docs.djangoproject.com/ru/stable/howto/static-files/)
- [Документация Django: Работа с медиафайлами](https://docs.djangoproject.com/ru/stable/topics/files/)

---
